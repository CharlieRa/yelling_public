<div class="messages" layout="column" layout-padding layout-align="start center" ng-style="{'background': 'url(' + bgUrl + ')'}">
  <md-whiteframe id="messagesBox" class="md-whiteframe-z5" layout="row" layout-align="start center" style="width:80%;" >
    <md-content flex scroll-bottom="messages" class="chatBox">
      <md-subheader>Mensajes</md-subheader>
      <!-- Progress circular mientras se cargan datos -->
      <div ng-hide="toggle.progress" layout="column" layout-sm="column" layout-align="center center">
        <md-progress-circular md-mode="indeterminate"></md-progress-circular>
      </div>
      <!-- Mensaje de Error si la aplicación no pudo obtener ubicación del usuario -->
      <div ng-show="toggle.error" layout="row" layout-margin layout-align="center center" flex>
        <md-card id="geoMessageError" flex="50">
          <md-card-content layout="column" layout-align="center center" >
            <md-icon md-svg-src="dist/icons/ic_mood_bad_black_48px.svg" aria-label="mood bad" id="moodBadIcon"></md-icon>
            <h3>Algo salio mal</h3>
            <p>{{error.message}}</p>
          </md-card-content>
        </md-card>
      </div>
      <!-- <div class="message-container" ng-repeat="message in messages" layout="column" layout-margin layout-align="start center"> -->
      <div layout="column">
        <div flex="auto" ng-repeat="message in messages">
          <md-card ng-show="toggle.yelling" id="messageBox" layout="row" layout-padding style="width:95%;">
            <img src="dist/img/avatar.jpg" alt="user avatar" style="width:auto;border-radius:5%;"></img>
            <md-card-content flex layout="column" layout-align="start start" layout-wrap layout-fill>
              <div id="messageHead" layout="row" layout-align="start start" flex="5">
                <span id="username" class="md-caption">Username </span>
                <span id="datetime" class="md-caption">Fecha: {{message.dateTime}}</span>
                <span id="datetime" class="md-caption">Distancia: {{message.dis}} metros</span>
              </div>
              <div flex="100" id="messageBody" layout="row" layout-align="start center" layout-wrap>
                  {{message.text}}
              </div>
              <div id="messageFooter" flex="5" layout-align="end center">
                  Distancia mensaje: {{message.dis}} metros <span class="md-body-1">Ubicacion mensaje: {{message.location[0]}} {{message.location[1]}}</span>
              </div>
            </md-card-content>
          </md-card>
        </div>
      </div>
    </md-content>
  </md-whiteframe>
  <form ng-show="toggle.yelling" ng-submit="$event.preventDefault()" name="formNewMessage" layout="row" style="width:80%" id="inputMessageBox">
    <md-input-container flex>
      <input ng-model="messages.newMessage" type="text" id="chatInput" md-maxlength="200" aria-label="New Message"/>
    </md-input-container>
    <md-button ng-click="sendMessage2()" class="md-fab md-primary" aria-label="Send">
      <md-icon md-svg-src="dist/icons/send.svg" aria-label="send"></md-icon>
    </md-button>
  </form>
</div>
